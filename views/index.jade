doctype html
html
  head
    title 
    meta(charset="utf-8")
    meta(name="description",content="")
    meta(name="keywords",content="")
    link(rel="stylesheet", href="bootstrap/dist/css/bootstrap.min.css")
    link(rel="stylesheet", href="bootstrap/dist/css/bootstrap-theme.min.css")
    style.
      #wrapper {
          padding-left: 0;
          -webkit-transition: all 0.5s ease;
          -moz-transition: all 0.5s ease;
          -o-transition: all 0.5s ease;
          transition: all 0.5s ease;
      }

      #wrapper.toggled {
          padding-left: 250px;
      }

      #sidebar-wrapper {
          z-index: 1000;
          position: fixed;
          left: 250px;
          width: 0;
          height: 100%;
          margin-left: -250px;
          overflow-y: auto;
          margin-top: -20px;
          -webkit-transition: all 0.5s ease;
          -moz-transition: all 0.5s ease;
          -o-transition: all 0.5s ease;
          transition: all 0.5s ease;
      }

      #wrapper.toggled #sidebar-wrapper {
          width: 250px;
      }

      #page-content-wrapper {
          width: 100%;
          position: absolute;
          padding: 15px;
      }

      #wrapper.toggled #page-content-wrapper {
          position: absolute;
          margin-right: -250px;
      }

      /* Sidebar Styles */

      .sidebar-nav {
          position: absolute;
          top: 0;
          width: 250px;
          margin: 0;
          padding: 0;
          list-style: none;
      }

      .sidebar-nav li {
          text-indent: 20px;
          line-height: 40px;
      }

      .sidebar-nav li a {
          display: block;
          text-decoration: none;
      }

      .sidebar-nav li a:hover {
          text-decoration: none;
      }

      .sidebar-nav li a:active,
      .sidebar-nav li a:focus {
          text-decoration: none;
      }

      .sidebar-nav > .sidebar-brand {
          height: 65px;
          font-size: 18px;
          line-height: 60px;
      }

      .sidebar-nav > .sidebar-brand a:hover {
          background: none;
      }

      @media(min-width:768px) {
          #wrapper {
              padding-left: 250px;
          }

          #wrapper.toggled {
              padding-left: 0;
          }

          #sidebar-wrapper {
              width: 250px;
          }

          #wrapper.toggled #sidebar-wrapper {
              width: 0;
          }

          #page-content-wrapper {
              padding: 20px;
              position: relative;
          }

          #wrapper.toggled #page-content-wrapper {
              position: relative;
              margin-right: 0;
          }
      }
  body
    nav.navbar.navbar-default
      div.collapse.navbar-collapse
        form.navbar-form.navbar-left
          div.form-group
            input(type="text", placeholder="Search channel", id="commandChannel").form-control
        form.navbar-form.navbar-left
          div.form-group
            input(type="text", placeholder="Search command", id="commandSearch").form-control
    div#wrapper
      div#sidebar-wrapper
        ul.sidebar-nav
      div.page-content-wrapper
        div.container-fluid
          div.row
            div.col-md-8.col-md-offset-2
              ul.list-group.row#cmds
                each key in Object.keys(cmds)
                  li.list-group-item.col-xs-3.btn.btn-link(data-cmd=cmds[key])= key
      
    script(type="text/javascript" src="jquery/dist/jquery.min.js")
    script(type="text/javascript" src="bootstrap/dist/js/bootstrap.min.js")
    script(type="text/javascript").
      $('#commandSearch').keyup(function(){
        $('#cmds li').removeClass('btn-warning')
        if ($('#commandSearch').val() !== '')
          $('#cmds li:contains("' + $('#commandSearch').val().toUpperCase() + '")').addClass('btn-warning');
      });
      
      $('#commandChannel').keyup(function(){
        $('#sidebar-wrapper li').hide();
        if ($('#commandChannel').val() !== '')
          $('#sidebar-wrapper li:contains("' + $('#commandChannel').val() + '")').show();
        else
          $('#sidebar-wrapper li').show();
      });
      
      
      $('#cmds li').click(function(){
        $.get('run/' + $(this).data('cmd')).done(function(resp){
          console.debug(resp);
        });
      });
      
      $('#sidebar-wrapper ul').on('click', 'li', function(){
        $.post('channels', $(this).data('channel')).done(function(resp){
          console.debug(resp);
        });
      });
      
      $.get('channels').done(function(resp){
        var channels = resp.envelope.data;
        for(var i = 0; i < channels.length; i++){
          var cha = channels[i];
          var li = $('<li>');
          li.addClass('btn-link');
          li.data('channel', {
            chname: cha.chname[0],
            major: cha.major[0],
            sourceIndex: cha.sourceIndex[0],
            physicalNum: cha.physicalNum[0],
            displayMajor: cha.displayMajor[0],
            minor: cha.minor[0],
            displayMinor: cha.displayMinor[0],
          });
          li.text(cha.chname[0] + 
          ' -' + 
          cha.displayMajor[0] + 
          '.' + 
          cha.displayMinor);
          $('#sidebar-wrapper ul').append(li);
        }
      });
